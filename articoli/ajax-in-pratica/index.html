<!doctype html><html class=no-js lang=it><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>AJAX in pratica - Giovanni Tomasicchio</title><script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="Creazione di uno script PHP che utilizza AJAX"><meta property="og:title" content="AJAX in pratica"><meta property="og:description" content="Creazione di uno script PHP che utilizza AJAX"><meta property="og:type" content="article"><meta property="og:url" content="https://giovannitomasicchio.github.io/articoli/ajax-in-pratica/"><meta property="article:section" content="articoli"><meta property="article:published_time" content="2005-07-29T18:55:45+00:00"><meta property="article:modified_time" content="2005-07-29T18:55:45+00:00"><meta itemprop=name content="AJAX in pratica"><meta itemprop=description content="Creazione di uno script PHP che utilizza AJAX"><meta itemprop=datePublished content="2005-07-29T18:55:45+00:00"><meta itemprop=dateModified content="2005-07-29T18:55:45+00:00"><meta itemprop=wordCount content="943"><meta itemprop=keywords content="AJAX,CSS,DOM,Javascript,XML,"><meta name=twitter:card content="summary"><meta name=twitter:title content="AJAX in pratica"><meta name=twitter:description content="Creazione di uno script PHP che utilizza AJAX"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,regular,italic,600,600italic,700,700italic,800,800italic|Kaushan+Script:regular"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-525H86QENV"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-525H86QENV',{anonymize_ip:!1})}</script></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Giovanni Tomasicchio" rel=home><div class="logo__item logo__text"><div class=logo__title>Giovanni Tomasicchio</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/><span class=menu__text>Home</span></a></li><li class=menu__item><a class=menu__link href=/articoli/><span class=menu__text>Articoli PHP</span></a></li><li class=menu__item><a class=menu__link href=/corsi/><span class=menu__text>Corsi</span></a></li><li class=menu__item><a class=menu__link href=/contatti/><span class=menu__text>Contatti</span></a></li><li class=menu__item><a class=menu__link href=/ricerca/><span class=menu__text>Ricerca</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>AJAX in pratica</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2005-07-29T18:55:45Z>29 July 2005</time></div></div></header><div class="content post__content clearfix"><p>Il termine <strong>AJAX</strong> sta per Asynchronous JavaScript and XML ed indica una tecnica per la realizzazione di applicazioni web estremamente interattive. Si basa sulla possibilità di modificare l&rsquo;HTML o il CSS di una pagina web attraverso l&rsquo;uso di Javascript (DHTML) a seguito di una interrogazione del server web.</p><p>Una tradizionale applicazione web prevede la costruzione di una pagina a seguito di ogni interrogazione del web server: l&rsquo;utente richiede una pagina ed il server la invia al browser. L&rsquo;interazione utente &lt;-> server risulta quindi sincrona. In una applicazione web che fa uso di tecniche AJAX invece è possibile effettuare una richiesta al server ed utilizzare le informazioni ricevute per modificare la pagina web mostrata dal browser senza doverla ricaricare completamente.</p><p>Questa dinamica si basa comunemente sui seguenti eventi:</p><ol><li><p>L&rsquo;utente interagisce con la pagina web, magari cliccando su di un link</p></li><li><p>Un Javascript raccoglie questa richiesta creando un oggetto di tipo XMLHttpRequest che viene fornito direttamente dal browser.</p></li><li><p>Attraverso questo oggetto il Javascript invia una richiesta al server remoto, usando il suo metodo &ldquo;send&rdquo;.</p></li><li><p>Il server web riceve ed elabora tale richiesta, magari attraverso un normale script PHP o più in generale attraverso un qualsiasi linguaggio di programmazione server-side.</p></li><li><p>La risposta del server web viene intercettata dal Javascript e non comporta quindi il completo aggiornamento della pagina mostrata dal browser.</p></li><li><p>Il Javascript estrapola i dati presenti nella risposta intercettata e modifica solo determinate porzioni di HTML della pagina web.</p></li></ol><p>Anche se a prima vista questa tecnica può sembrare alquanto complessa, in realtà si riduce all&rsquo;uso di un po' di Javascript e PHP. Ed è proprio il papà del PHP, <a href=http://lerdorf.com/bio.php>Rasmus Lerdorf</a>, a sottolineare come non sia difficile implementare AJAX su una pagina web.</p><p>In un <a href="http://marc.theaimsgroup.com/?l=php-general&m=112198633625636&w=2">messaggio</a> dal titolo &ldquo;Rasmus' 30 second AJAX Tutorial&rdquo; sulla mailing list <a href=http://www.php.net/mailing-lists.php>php-general</a>, Rasmus Lerdorf presenta un breve tutorial su AJAX che vale la pena leggere e che riportiamo nella prossima pagina. Abbiamo preventivamente contattato Rasmus che con un lapidario &ldquo;Sure, go ahead.&rdquo; ci ha concordato il permesso di pubblicare il suo tutorial.</p><hr><p>Ecco il breve ma efficace tutorial di Rasmus Lerdorf su AJAX:</p><p>Trovo che AJAX sia un po' una montatura. Molte persone hanno usato tecniche simili, prima che queste fossero chiamate &ldquo;AJAX&rdquo;. E non si tratta di cose complicate come molti fanno credere. Ecco un semplice esempio tratto da una mia applicazione. Iniziamo con il Javascript:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>createRequestObject</span>() {
   <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ro</span>;
   <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>browser</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>appName</span>;
   <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>browser</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Microsoft Internet Explorer&#34;</span>){
       <span style=color:#a6e22e>ro</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ActiveXObject</span>(<span style=color:#e6db74>&#34;Microsoft.XMLHTTP&#34;</span>);
   }<span style=color:#66d9ef>else</span>{
       <span style=color:#a6e22e>ro</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>XMLHttpRequest</span>();
   }
   <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ro</span>;
}

<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>http</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createRequestObject</span>();

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sndReq</span>(<span style=color:#a6e22e>action</span>) {
   <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>open</span>(<span style=color:#e6db74>&#39;get&#39;</span>, <span style=color:#e6db74>&#39;rpc.php?action=&#39;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>action</span>);
   <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>onreadystatechange</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>handleResponse</span>;
   <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>null</span>);
}

<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleResponse</span>() {
   <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>readyState</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>){
       <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>responseText</span>;
       <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>update</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array();

       <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;|&#39;</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)) {
           <span style=color:#a6e22e>update</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;|&#39;</span>);
           document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#a6e22e>update</span>[<span style=color:#ae81ff>0</span>]).<span style=color:#a6e22e>innerHTML</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>update</span>[<span style=color:#ae81ff>1</span>];
       }
   }
}
</code></pre></div><p>Questo script definisce una funzione per la creazione di un oggetto <em>Request</em>, una funzione per l&rsquo;invio di tale richiesta ed una funzione per la gestione della risposta. Per essere usato, questo script va inserito all&rsquo;interno di una pagina web.
Per effettuare una richiesta al backend possiamo collegare tale script ad un evento &ldquo;onClick&rdquo; oppure direttamente all&rsquo;attributo <em>href</em> di un link, nel seguente modo:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;a</span> <span style=color:#a6e22e>href=</span><span style=color:#e6db74>&#34;javascript:sndReq(&#39;foo&#39;)&#34;</span><span style=color:#f92672>&gt;</span>[foo]<span style=color:#f92672>&lt;/a&gt;</span>
</code></pre></div><p>Questo fa si che quando un utente clicca sul link venga inviata una richiesta alla pagina rpc.php?action=foo</p><p>Nel file rpc.php potremmo inserire qualcosa di simile:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#66d9ef>switch</span>($_REQUEST[<span style=color:#e6db74>&#39;action&#39;</span>]) { 
   <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;foo&#39;</span><span style=color:#f92672>:</span> 
   <span style=color:#75715e>/* do something */</span> 
   <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;foo|foo done&#34;</span>; 
   <span style=color:#66d9ef>break</span>; 

<span style=color:#f92672>...</span> 
}
</code></pre></div><p>Adesso osserviamo la funzione <em>handleResponse</em>. Essa effettua il parsing della stringa &ldquo;foo|foo done&rdquo; e la divide in 2 parti in modo da usare il testo che precede il carattere &lsquo;|&rsquo; come l&rsquo;id di un elemento dom della pagina, ed il testo successivo al carattere &lsquo;|&rsquo; come il nuovo HTML da inserire in tale elemento dom. Ciò significa che se abbiamo nella pagina un tag div come il seguente:</p><pre><code>&lt;pre class=&quot;brush: xml&quot;&gt;
</code></pre><pre><code>&lt;pre class=&quot;brush: xml&quot;&gt;
   
</code></pre><p>una volta cliccato sul link di prima, tale tag cambierà in:</p><pre><code>&lt;pre class=&quot;brush: xml&quot;&gt;
</code></pre><pre><code>&lt;pre class=&quot;brush: xml&quot;&gt;
   
foo done 
</code></pre><p>Questo è tutto. Tutto il resto sono solo evoluzioni di tale tecnica che sostituiscono la semplice risposta &ldquo;id|text&rdquo; con un formato XML più elaborato ed inoltre rendono la richiesta molto più complessa. Prima di installare alla cieca qualche voluminosa libreria &ldquo;AJAX&rdquo;, bisognerebbe provare a realizzare tali funzionalità da soli in modo da comprenderne esattamente il funzionamento e aumentarne la complessità solo se necessario. Spesso infatti non serve più di quanto appena mostrato.</p><p>Per estendere questo approccio all&rsquo;invio nella richiesta di più parametri si potrebbe semplicemente procedere così:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sndReqArg</span>(<span style=color:#a6e22e>action</span>,<span style=color:#a6e22e>arg</span>) { 
   <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>open</span>(<span style=color:#e6db74>&#39;get&#39;</span>, <span style=color:#e6db74>&#39;rpc.php?action=&#39;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>action</span><span style=color:#f92672>+</span><span style=color:#e6db74>&#39;&amp;arg=&#39;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>arg</span>); 
   <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>onreadystatechange</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>handleResponse</span>; 
   <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>send</span>(<span style=color:#66d9ef>null</span>); 
}
</code></pre></div><p>Anche la funzione handleResponse può essere modificata affinché faccia qualcosa di più interessante di modificare il contenuto di un tag div.</p><hr><p>Come sottolineato da Rasmus Lerdorf, il principio di funzionamento di AJAX non è di recente invenzione anche se stentano a diffondersi tali tecniche nelle comuni applicazioni web. Forse è proprio Google, con il suo servizio di posta Gmail, a costituire uno degli esempi meglio riusciti in questo campo.</p><p>I benefici sono molteplici. A cominciare dalla notevole interattività che è possibile realizzare e che permette di portare a pieno titolo il pattern MVC (Model-View-Controller) nelle applicazioni web. Inoltre la possibilità di scambiare col server solo le informazioni veramente necessarie comporta un notevole risparmio di banda ed una conseguente riduzione dei tempi di risposta (non serve più ridisegnare l&rsquo;intera pagina ad ogni interazione)</p><p>Non mancano però i lati negativi, primo fra tutti la compatibilità tra i vari browser anche se le più recenti versioni non sembrano avere problemi.</p><p>AJAX è sicuramente una tecnica da provare, permette infatti di superare molti dei limiti di una comune applicazione web e conferisce ad essa un livello di interattività ed tocco di professionalità senza pari.</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/ajax/ rel=tag>AJAX</a></li><li class=tags__item><a class="tags__link btn" href=/tags/css/ rel=tag>CSS</a></li><li class=tags__item><a class="tags__link btn" href=/tags/dom/ rel=tag>DOM</a></li><li class=tags__item><a class="tags__link btn" href=/tags/javascript/ rel=tag>Javascript</a></li><li class=tags__item><a class="tags__link btn" href=/tags/xml/ rel=tag>XML</a></li></ul></div></footer></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/articoli/evitare-laccesso-diretto-ad-un-file/ rel=prev><span class=pager__subtitle>«&#8201;Precedente</span><p class=pager__title>Evitare l'accesso diretto ad un file</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/articoli/cronometriamo-i-nostri-script/ rel=next><span class=pager__subtitle>Prossimo&#8201;»</span><p class=pager__title>Cronometriamo i nostri script</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//giovannitomasicchio-it.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2021 Giovanni Tomasicchio.
<span class=footer__copyright-credits>Generato con <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> e il tema <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a>.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>